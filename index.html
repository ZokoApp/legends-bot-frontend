<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Legends Bot – Producción</title>

<script>
const user = JSON.parse(localStorage.getItem("legends_user"));
if (!user) window.location.href = "login.html";
</script>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b1220">

<style>
*{box-sizing:border-box}
body{
margin:0;
font-family:system-ui;
background:radial-gradient(circle at top,#0f172a,#020617);
color:#e5e7eb;
}

.container{max-width:420px;margin:0 auto;padding:28px 20px 40px}
.card{background:rgba(255,255,255,0.04);border-radius:20px;padding:26px 22px 28px;box-shadow:0 30px 60px rgba(0,0,0,.5)}

.user-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:22px}
.user-info{display:flex;align-items:center;gap:12px}
.user-info img{width:46px;height:46px;border-radius:50%}
.user-name{font-size:.8rem;color:#9ca3af}
.user-name strong{display:block;font-size:.95rem;color:#fff}

.btn-logout{
padding:6px 14px;
border-radius:12px;
border:1px solid rgba(255,255,255,.2);
background:transparent;
color:#9ca3af;
font-size:.75rem;
cursor:pointer;
}

.field{margin-bottom:18px}
.field label{display:block;font-size:.75rem;color:#9ca3af;margin-bottom:6px}
.field input,.field select{
width:100%;
padding:14px;
border-radius:14px;
border:none;
background:#020617;
color:#e5e7eb;
font-size:.9rem;
}

/* MODE MENU */
.mode-menu{
display:grid;
grid-template-columns:1fr 1fr;
gap:12px;
}

.mode-btn{
padding:14px;
border-radius:14px;
background:#020617;
border:1px solid rgba(255,255,255,.1);
color:white;
font-weight:700;
cursor:pointer;
font-size:14px;
}

.mode-btn.active{
background:linear-gradient(145deg,#2563eb,#1e40af);
box-shadow:0 0 12px rgba(37,99,235,.6);
}

/* BUTTONS */
.actions{display:flex;gap:12px;margin-top:20px}
.btn-primary{background:linear-gradient(135deg,#2563eb,#1e40af);color:#fff}
.btn-secondary{background:transparent;color:#9ca3af;border:1px solid rgba(255,255,255,.2)}

.status{margin-top:16px;font-size:.75rem;display:flex;gap:6px;align-items:center}
.dot{width:8px;height:8px;border-radius:50%;background:#22c55e}

/* MODALES */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;justify-content:center;align-items:center;z-index:9999}
.modal-card{width:95%;max-width:520px;background:#020617;border-radius:20px;padding:18px}
</style>
</head>

<body>

<div class="container">
<div class="card">

<div class="user-header">
  <div class="user-info">
    <img src="icons/icon-192.png">
    <div class="user-name">
      <strong id="userName"></strong>
      <span id="userRole"></span>
    </div>
  </div>
  <div>
    <button class="btn-logout" onclick="openHistory()">Historial</button>
    <button class="btn-logout" onclick="logout()">Salir</button>
  </div>
</div>

<div class="field">
<label>COMPAÑÍA</label>
<select id="company">
<option value="VTR">VTR</option>
<option value="CLARO">CLARO</option>
</select>
</div>

<div class="field">
<label>MODO</label>
<div class="mode-menu">
  <button class="mode-btn" onclick="setMode('factibilidad',this)">Factibilidad</button>
  <button class="mode-btn" onclick="setMode('validacion',this)">Estado Venta</button>
  <button class="mode-btn" onclick="setMode('agenda',this)">Agenda</button>
  <button class="mode-btn" onclick="setMode('boleta',this)">Boleta</button>
</div>
<input type="hidden" id="mode">
</div>

<div class="field"><label>Dirección</label><input id="address"></div>
<div class="field"><label>Comuna</label><input id="comuna"></div>
<div class="field"><label>Cuenta de Facturación (NO RUT)</label><input id="rut"></div>

<div class="actions">
<button id="btnRun" class="btn-primary">Ejecutar</button>
<button id="btnClear" class="btn-secondary">Limpiar</button>
</div>

<div class="status">
<div class="dot"></div>
<span id="statusText">Conectado a Legends Bot</span>
</div>

</div>
</div>

<script src="app.js"></script>

<script>
document.getElementById("userName").innerText = user.nombre;
document.getElementById("userRole").innerText = user.rol;

function logout(){
  localStorage.removeItem("legends_user");
  window.location.href="login.html";
}

function setMode(mode,btn){
  document.getElementById("mode").value = mode;
  document.querySelectorAll(".mode-btn").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}
</script>

</body>
</html>
